<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airflow Certification | FKTI</title>
    <link rel="stylesheet" href="../css/fkti-light-theme.css">
    <style>
        .page-header {
            text-align: center;
            padding: 48px 20px 32px;
            border-bottom: 1px solid #e5e5e5;
        }
        .logo-text {
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.5px;
            color: #86868b;
            margin-bottom: 16px;
        }
        .page-header h1 {
            font-size: 32px;
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 8px;
        }
        .page-header p {
            font-size: 17px;
            color: #86868b;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            justify-content: center;
            gap: 24px;
            padding: 16px 20px;
            border-bottom: 1px solid #e5e5e5;
            background: #fbfbfd;
            position: sticky;
            top: 48px;
            z-index: 100;
        }
        .tab {
            background: none;
            border: none;
            font-size: 14px;
            color: #86868b;
            cursor: pointer;
            padding: 8px 0;
            font-family: inherit;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }
        .tab:hover { color: #1d1d1f; }
        .tab.active {
            color: #1d1d1f;
            border-bottom-color: #1d1d1f;
        }
        
        /* Content */
        .cert-content {
            max-width: 680px;
            margin: 0 auto;
            padding: 32px 20px 60px;
        }
        .section { display: none; }
        .section.active { display: block; }
        
        /* Results */
        .results {
            text-align: center;
            padding: 32px;
            background: #f5f5f7;
            border-radius: 12px;
            margin-bottom: 24px;
            display: none;
        }
        .results.show { display: block; }
        .score { font-size: 48px; font-weight: 600; color: #1d1d1f; }
        .score-msg { font-size: 17px; color: #86868b; margin-top: 8px; }
        .score-msg.pass { color: #34c759; }
        .score-msg.fail { color: #ff3b30; }
        .stats { display: flex; justify-content: center; gap: 40px; margin-top: 20px; }
        .stat-val { font-size: 24px; font-weight: 600; }
        .stat-val.correct { color: #34c759; }
        .stat-val.wrong { color: #ff3b30; }
        .stat-lbl { font-size: 12px; color: #86868b; }
        
        /* Actions */
        .actions {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 24px;
        }
        .btn {
            background: #06c;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 14px;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
        }
        .btn.secondary {
            background: #f5f5f7;
            color: #1d1d1f;
        }
        .btn:hover { opacity: 0.9; }
        .btn.hidden { display: none; }
        
        /* Questions */
        .question {
            background: white;
            border: 1px solid #e5e5e5;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
        }
        .q-meta {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }
        .q-num {
            font-size: 11px;
            font-weight: 600;
            color: #06c;
            background: #e8f4fd;
            padding: 2px 8px;
            border-radius: 10px;
        }
        .q-cat {
            font-size: 11px;
            color: #86868b;
            background: #f5f5f7;
            padding: 2px 8px;
            border-radius: 10px;
        }
        .q-text {
            font-size: 15px;
            color: #1d1d1f;
            margin-bottom: 16px;
            line-height: 1.5;
        }
        .q-text pre {
            background: #f5f5f7;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            overflow-x: auto;
            margin: 8px 0;
        }
        
        /* Options */
        .options { display: flex; flex-direction: column; gap: 8px; }
        .opt {
            display: flex;
            align-items: center;
            padding: 12px;
            background: #f5f5f7;
            border: 1px solid transparent;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .opt:hover { background: #ebebed; }
        .opt input { margin-right: 10px; accent-color: #06c; }
        .opt.correct { background: #e8f8ec; border-color: #34c759; }
        .opt.wrong { background: #ffebeb; border-color: #ff3b30; }
        
        /* Answer badge */
        .answer {
            margin-top: 12px;
            padding: 8px 12px;
            background: #e8f8ec;
            border-radius: 6px;
            font-size: 13px;
            color: #1d7a3a;
        }
        
        /* Explanation */
        .explanation {
            margin-top: 12px;
            padding: 12px;
            background: #f5f5f7;
            border-radius: 8px;
            font-size: 13px;
            color: #6e6e73;
            line-height: 1.5;
        }
        .explanation strong { color: #1d1d1f; }
        
        /* Back link */
        .back-link {
            display: inline-block;
            padding: 12px 20px;
            color: #06c;
            text-decoration: none;
            font-size: 14px;
        }
        .back-link:hover { text-decoration: underline; }
        
        @media (max-width: 600px) {
            .page-header { padding: 32px 16px 24px; }
            .page-header h1 { font-size: 24px; }
            .tabs { gap: 16px; top: 40px; }
            .tab { font-size: 12px; }
            .cert-content { padding: 20px 16px 40px; }
            .question { padding: 16px; }
        }
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Simple Nav -->
    <nav id="navbar">
        <div class="container">
            <a href="../index.html" class="nav-btn">Home</a>
            <a href="hub.html" class="nav-btn">Course Hub</a>
            <span class="nav-btn" style="opacity: 1;">Certification</span>
            <a href="../python_course/index.html" class="nav-btn">Python</a>
        </div>
    </nav>

    <!-- Header -->
    <div class="page-header">
        <div class="logo-text">FKTI</div>
        <h1>Airflow Certification</h1>
        <p>75 Questions Â· Complete Study Guide</p>
    </div>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab active" onclick="showTab('study')">Study</button>
        <button class="tab" onclick="showTab('quiz')">Quiz</button>
        <button class="tab" onclick="showTab('answers')">Answers</button>
    </div>

    <!-- Content -->
    <div class="cert-content">
        <!-- Results (Quiz) -->
        <div class="results" id="results">
            <div class="score" id="score">0%</div>
            <div class="score-msg" id="score-msg">Your Score</div>
            <div class="stats">
                <div><div class="stat-val correct" id="correct">0</div><div class="stat-lbl">Correct</div></div>
                <div><div class="stat-val wrong" id="wrong">0</div><div class="stat-lbl">Wrong</div></div>
            </div>
        </div>
        
        <!-- Actions (Quiz) -->
        <div class="actions" id="actions" style="display: none;">
            <button class="btn" id="submit-btn" onclick="submitQuiz()">Submit</button>
            <button class="btn hidden" id="reveal-btn" onclick="revealAnswers()">Show Answers</button>
            <button class="btn secondary" onclick="resetQuiz()">Reset</button>
        </div>

        <!-- Study Section -->
        <div class="section active" id="study-section"></div>
        
        <!-- Quiz Section -->
        <div class="section" id="quiz-section"></div>
        
        <!-- Answers Section -->
        <div class="section" id="answers-section"></div>
    </div>

    <script>
        const questions = [
            { id: 1, q: "Assume an Airflow variable with the name airtable_api_key was created via the Airflow UI. Will the variable's value be hidden on the Airflow UI?", opts: ["Yes", "No"], ans: [0], type: "single", cat: "Variables", exp: "Airflow automatically masks variables containing sensitive keywords like 'api_key', 'password', 'secret'." },
            { id: 2, q: "Is this the correct way to create a PostgreSQL connection?\n\nAIRFLOW_CONN_POSTGRES='my-conn-type://login:password@host:port/schema'", opts: ["Yes", "No"], ans: [1], type: "single", cat: "Connections", exp: "No. 'my-conn-type' is invalid. Use 'postgresql' or 'postgres'." },
            { id: 3, q: "What is a DAG run?", opts: ["A special Airflow object that determines the schedule of a DAG", "A specific run or instance of a task", "A specific run or instance of a DAG", "An object grouping all DAGs"], ans: [2], type: "single", cat: "Core Concepts", exp: "A DAG run represents a single execution of a DAG at a specific point in time." },
            { id: 4, q: "With [task_a(), task_b()] >> task_e() and [task_c(), task_d()] >> task_e(), how many tasks run at the same time?", opts: ["4", "1", "0", "2"], ans: [0], type: "single", cat: "Dependencies", exp: "4 tasks (a, b, c, d) have no upstream dependencies, so they all run in parallel." },
            { id: 5, q: "Which feature allows tasks to communicate and share data?", opts: ["Variables", "Connections", "XCom", "Hooks"], ans: [2], type: "single", cat: "Core Concepts", exp: "XCom (Cross-Communication) is Airflow's mechanism for tasks to exchange data." },
            { id: 6, q: "With @daily schedule and catchup=True, how far back will Airflow catch up?", opts: ["To the beginning of time", "One week", "One month", "To the DAG's start_date"], ans: [3], type: "single", cat: "Scheduling", exp: "Airflow backfills from start_date to current date." },
            { id: 7, q: "A Python script downloads data from an API and stores it daily. Is this a use case for Airflow?", opts: ["Yes", "No"], ans: [0], type: "single", cat: "Use Cases", exp: "Yes! Scheduled data pipelines are ideal for Airflow." },
            { id: 8, q: "Which parameter limits a DAG to run only for the next two months?", opts: ["start_date", "schedule", "end_date", "catchup"], ans: [2], type: "single", cat: "DAG Parameters", exp: "end_date stops scheduling after a specific date." },
            { id: 9, q: "A new task doesn't appear in the UI. Why?", opts: ["The schedule parameter is missing", "The task dependency setup is incorrect", "Airflow has a default delay of up to 30 seconds", "Airflow has a default delay of up to 5 minutes"], ans: [2], type: "single", cat: "Troubleshooting", exp: "min_file_process_interval defaults to 30 seconds for re-parsing existing files." },
            { id: 10, q: "What is the role of the executor?", opts: ["It deletes unwanted tasks", "It defines how tasks are executed and on which system", "It executes tasks", "It schedules tasks"], ans: [1], type: "single", cat: "Architecture", exp: "The executor defines the mechanism for running tasks (Local, Celery, Kubernetes, etc.)." },
            { id: 11, q: "Which mode is best when poke_interval > 5 minutes?", opts: ["reschedule", "poke"], ans: [0], type: "single", cat: "Sensors", exp: "reschedule mode releases the worker slot between pokes." },
            { id: 12, q: "Schedule for every 10 minutes, but not on weekends?", opts: ["schedule='/10 * * * *'", "schedule='*/10 * * * 1-5'", "schedule=timedelta(minutes=10)", "schedule='*/10 * * * M-F'"], ans: [1], type: "single", cat: "Scheduling", exp: "'*/10 * * * 1-5' = every 10 min, Mon-Fri." },
            { id: 13, q: "Which are valid schedule values? (select all)", opts: ["Timedelta", "Integers", "Calendar", "Cron"], ans: [0, 3], type: "multiple", cat: "Scheduling", exp: "Valid: Cron strings, Timedelta objects, Timetables, None, Datasets." },
            { id: 14, q: "A new DAG file doesn't show up. Why? (select all)", opts: ["The code doesn't contain 'airflow' or 'dag'", "The Airflow instance must be restarted", "5 minute default delay", "The .airflowignore file has the name"], ans: [0, 2, 3], type: "multiple", cat: "Troubleshooting", exp: "Airflow scans for keywords, has 5-min delay for new files, and respects .airflowignore." },
            { id: 15, q: "What is the default value for start_date?", opts: ["datetime.now()", "datetime(2020, 1, 1)", "None", "Yesterday"], ans: [2], type: "single", cat: "DAG Parameters", exp: "start_date defaults to None." },
            { id: 16, q: "Which sets start date to 2025/01/01?", opts: ["start_date=datetime(2025, 1, 1)", "schedule=datetime(2025, 1, 1)", "start_date=datetime(1, 1, 2025)", "start_date='2025/01/01'"], ans: [0], type: "single", cat: "DAG Parameters", exp: "Format: datetime(year, month, day)." },
            { id: 17, q: "Daily DAG at 00:00, start_date Jan 1, 2025. What's the first logical_date?", opts: ["2025/01/01 00:00", "2025/01/02 00:00", "2025/01/01 00:01", "2025/01/02 23:59"], ans: [0], type: "single", cat: "Scheduling", exp: "logical_date = start of the data interval (2025-01-01 00:00)." },
            { id: 18, q: "XCom limitations? (select all)", opts: ["XComs are the only way to share data", "Requires a defined DAG with at least one task", "Data size is limited", "Max 2 tasks can use XCom"], ans: [1, 2], type: "multiple", cat: "XCom", exp: "XCom requires task context and has size limits." },
            { id: 19, q: "How to avoid dag=dag in all operators? (select all)", opts: ["Using @dag decorator", "Giving all tasks the same task_id", "Using 'with DAG()' context manager", "Creating default_argument dictionary"], ans: [0, 2], type: "multiple", cat: "DAG Definition", exp: "@dag decorator or context manager auto-associates tasks." },
            { id: 20, q: "What is the default timezone in Airflow?", opts: ["Local timezone", "EST", "UTC", "PST"], ans: [2], type: "single", cat: "Configuration", exp: "Airflow uses UTC by default." },
            { id: 21, q: "What is the typical task journey?", opts: ["No status â†’ Scheduled â†’ Queued â†’ Running â†’ Success/Failure", "Queued â†’ Scheduled â†’ Running â†’ Success/Failure", "No status â†’ Queued â†’ Scheduled â†’ Running â†’ Success/Failure", "Scheduled â†’ Queued â†’ Running â†’ Success/Failure"], ans: [0], type: "single", cat: "Core Concepts", exp: "No status â†’ Scheduled â†’ Queued â†’ Running â†’ Success/Failure." },
            { id: 22, q: "DAG missing start_date, task/dag not called. Issues? (select all)", opts: ["start_date missing", "tags missing", "Task not called", "DAG not called"], ans: [0, 2, 3], type: "multiple", cat: "Troubleshooting", exp: "Missing start_date, task not called, DAG not called. Tags are optional." },
            { id: 23, q: "Purpose of task dependencies?", opts: ["Ensure correct execution order", "Reduce task failures", "Increase parallelism", "Improve scheduler performance"], ans: [0], type: "single", cat: "Dependencies", exp: "Dependencies define execution order." },
            { id: 24, q: "What is XCom?", opts: ["A real-time communication protocol", "A way to store data between tasks", "A data serialization tool", "A type of task"], ans: [1], type: "single", cat: "XCom", exp: "XCom shares data between tasks." },
            { id: 25, q: "Default sensor timeout?", opts: ["7 hours", "7 days", "1 day", "1 minute"], ans: [1], type: "single", cat: "Sensors", exp: "Default timeout is 7 days." },
            { id: 26, q: "What does the bar chart show in DAGs view?", opts: ["Future DAG runs", "Previous DAG runs only", "Task instances with states", "Past and current DAG runs with states"], ans: [3], type: "single", cat: "UI", exp: "Shows recent DAG runs and their statuses." },
            { id: 27, q: "Why doesn't the DAG show up? (my_dag function not called)", opts: ["my_dag isn't called", "schedule missing", "catchup missing", "start_date format wrong"], ans: [0], type: "single", cat: "Troubleshooting", exp: "When using @dag, you must call the decorated function." },
            { id: 28, q: "Jan 4, start_date Jan 1, @daily, default catchup. How many DAG runs?", opts: ["4", "1", "0", "2"], ans: [0], type: "single", cat: "Scheduling", exp: "4 completed intervals (Jan 1â†’2, 2â†’3, 3â†’4, 4â†’now)." },
            { id: 29, q: "Which parameter defines when scheduling starts?", opts: ["schedule", "end_date", "start_date", "dag_id"], ans: [2], type: "single", cat: "DAG Parameters", exp: "start_date defines when scheduling begins." },
            { id: 30, q: "Which creates t0 â†’ t1 â†’ t2 â†’ t3?", opts: ["[t0, t1] >> [t2, t3]", "[t0, t1] >> t2 >> t3", "t0 >> t1 >> t2 >> t3", "t0 >> t1 >> [t2, t3]"], ans: [2], type: "single", cat: "Dependencies", exp: "t0 >> t1 >> t2 >> t3 creates linear flow." },
            { id: 31, q: "Valid ways to create a pipeline? (select all)", opts: ["Using with DAG()", "Using DAG class with dag parameter", "Creating a function called DAG", "Using @dag decorator"], ans: [0, 1, 3], type: "multiple", cat: "DAG Definition", exp: "Valid: @dag, with DAG(), DAG class with dag=." },
            { id: 32, q: "Can you backfill with catchup=False?", opts: ["No, impossible", "Yes, with UI, API, or CLI"], ans: [1], type: "single", cat: "Backfill", exp: "You can manually backfill even with catchup=False." },
            { id: 33, q: "Would task_a() >> task_b (missing parentheses) work?", opts: ["Yes", "No"], ans: [1], type: "single", cat: "Troubleshooting", exp: "No, task_b without () is a decorator object, not a task." },
            { id: 34, q: "What does 'Latest Run' column show?", opts: ["Logical date of latest DAG run", "Interval between runs", "End date/time of most recent run", "Next scheduled run"], ans: [0], type: "single", cat: "UI", exp: "Shows the logical_date of the most recent DAG run." },
            { id: 35, q: "Presto provider missing. What to do?", opts: ["Reinstall Airflow", "Restart Airflow", "Impossible", "Install the provider package"], ans: [3], type: "single", cat: "Providers", exp: "Install: pip install apache-airflow-providers-presto" },
            { id: 36, q: "Best view for DAG runs and task states overview?", opts: ["Graph view", "Grid view", "DAGs view"], ans: [1], type: "single", cat: "UI", exp: "Grid view shows tasks Ã— runs matrix." },
            { id: 37, q: "True about DAG? (select all)", opts: ["Loops are good practice", "DAG is a programming language", "DAG = Directed Acyclic Graph", "Nodes = tasks, edges = dependencies"], ans: [2, 3], type: "multiple", cat: "Core Concepts", exp: "DAG = Directed Acyclic Graph. No loops allowed." },
            { id: 38, q: "Purpose of Airflow variable? (select all)", opts: ["Store XCom", "Reuse value across DAGs", "Store large data", "Avoid hardcoding"], ans: [1, 3], type: "multiple", cat: "Variables", exp: "Variables store config values and avoid hardcoding." },
            { id: 39, q: "CLI command to run a task without dependencies?", opts: ["airflow tasks start", "airflow dags test", "airflow standalone", "airflow tasks test"], ans: [3], type: "single", cat: "CLI", exp: "airflow tasks test runs a task in isolation." },
            { id: 40, q: "What can be stored in a variable? (select all)", opts: ["Integers", "Strings", "Python Dataclasses", "JSON"], ans: [1, 3], type: "multiple", cat: "Variables", exp: "Strings and JSON (with deserialize_json=True)." },
            { id: 41, q: "What does a Transfer Operator do?", opts: ["Moves data between systems", "Transforms data format", "Sends notifications", "Evaluates conditions"], ans: [0], type: "single", cat: "Operators", exp: "Transfer Operators move data from one system to another." },
            { id: 42, q: "Purpose of default_args?", opts: ["Specifies schedule interval", "Specifies operator to use", "Default params for one task", "Default params for all tasks"], ans: [3], type: "single", cat: "DAG Parameters", exp: "default_args applies to ALL tasks in the DAG." },
            { id: 43, q: "What does a Sensor Operator do?", opts: ["Waits for a condition", "Evaluates conditions for branching", "Sends notifications", "Provides utility functions"], ans: [0], type: "single", cat: "Sensors", exp: "Sensors wait for a condition to be true." },
            { id: 44, q: "Is [t0, t1] >> t2 >> [t3, t4] >> t5 valid?", opts: ["No", "Yes"], ans: [1], type: "single", cat: "Dependencies", exp: "Yes, valid Airflow syntax." },
            { id: 45, q: "Jan 8 10:00, start_date Jan 5, catchup=True. How many DAG runs?", opts: ["4", "2", "1", "3"], ans: [3], type: "single", cat: "Scheduling", exp: "3 completed intervals: 5â†’6, 6â†’7, 7â†’8." },
            { id: 46, q: "Optional params without @dag? (select all)", opts: ["schedule_interval", "start_date", "default_args", "dag_id"], ans: [0, 1, 2], type: "multiple", cat: "DAG Parameters", exp: "Only dag_id is required." },
            { id: 47, q: "How can Airflow help build a user behavior dashboard?", opts: ["As the database", "To schedule pipelines feeding a data warehouse", "To analyze events and present dashboards", "To build dashboards in the UI"], ans: [1], type: "single", cat: "Use Cases", exp: "Airflow orchestrates pipelines, not databases or dashboards." },
            { id: 48, q: "Can env variable variables be accessed in DAGs even if not in UI?", opts: ["Yes", "No"], ans: [0], type: "single", cat: "Variables", exp: "Yes, via Variable.get()." },
            { id: 49, q: "Result of chain(t0, t1, [t2, t3], [t4, t5], t6)?", opts: ["chain(t0, t1, [t2, t4], [t3, t5], t6)", "t0 >> t1 >> [t2, t3] >> [t4, t5] >> t6", "chain(t0, t1, [t2, t3], [t4, t5], t6)", "[t0, t1] >> t2 >> t3 >> t4 >> [t5, t6]"], ans: [2], type: "single", cat: "Dependencies", exp: "chain() with lists connects corresponding elements." },
            { id: 50, q: "Valid ways to create a connection? (select all)", opts: ["Airflow CLI", "In an XCom", "Airflow UI", "Environment Variables"], ans: [0, 2, 3], type: "multiple", cat: "Connections", exp: "CLI, UI, or AIRFLOW_CONN_* env vars." },
            { id: 51, q: "Best mode when poke_interval < 5 minutes?", opts: ["reschedule", "poke"], ans: [1], type: "single", cat: "Sensors", exp: "poke mode is best for short intervals." },
            { id: 52, q: "Which folder does the scheduler parse for DAGs?", opts: ["/plugins", "/dags", "/include", "/airflow"], ans: [1], type: "single", cat: "Configuration", exp: "/dags folder contains DAG files." },
            { id: 53, q: "Method to add data to XCom?", opts: ["xcom parameter of DAG", "xcom_push", "xcom_add", "xcom_pull"], ans: [1], type: "single", cat: "XCom", exp: "Use xcom_push to add data." },
            { id: 54, q: "What does 'queued' status mean?", opts: ["Task is running", "Task executes immediately", "Task waiting to be scheduled", "Task assigned to executor, awaiting worker"], ans: [3], type: "single", cat: "Core Concepts", exp: "Queued = sent to executor, waiting for worker." },
            { id: 55, q: "Is daily SQL aggregation a use case for Airflow?", opts: ["No", "Yes"], ans: [1], type: "single", cat: "Use Cases", exp: "Yes, perfect use case!" },
            { id: 56, q: "Purpose of PythonOperator?", opts: ["Deploy Python packages", "Execute Python code as a task", "Schedule Python scripts", "Manage virtual environments"], ans: [1], type: "single", cat: "Operators", exp: "PythonOperator executes a Python function as a task." },
            { id: 57, q: "Is automated failure notification a use case for Airflow?", opts: ["No", "Yes"], ans: [1], type: "single", cat: "Use Cases", exp: "Yes! Airflow provides email_on_failure, Slack, etc." },
            { id: 58, q: "Correct env var for variable 'customer_folder'='my_folder'?", opts: ["AIRFLOW_VARIABLE_CUSTOMER_FOLDER='my_folder'", "CUSTOMER_FOLDER='my_folder'", "AIRFLOW_VAR_CUSTOMER_FOLDER='my_folder'", "AIRFLOW_CUSTOMER_FOLDER='my_folder'"], ans: [2], type: "single", cat: "Variables", exp: "Format: AIRFLOW_VAR_<NAME_UPPERCASE>=value" },
            { id: 59, q: "Which creates t0 â†’ t1 â†’ t2 â†’ t3? (select all)", opts: ["t3 << t2 << t1 << t0", "t0 >> t1 >> t2 >> t3", "t0 >> [t1, t2] >> t3", "t0 >> [t1, t2, t3]"], ans: [0, 1], type: "multiple", cat: "Dependencies", exp: "Both >> and << create the same chain." },
            { id: 60, q: "CLI command showing Python version?", opts: ["airflow version", "airflow python version", "airflow info", "airflow standalone"], ans: [2], type: "single", cat: "CLI", exp: "airflow info shows environment details." },
            { id: 61, q: "Best view for understanding task dependencies?", opts: ["Graph view", "Grid view", "DAGs view"], ans: [0], type: "single", cat: "UI", exp: "Graph view shows tasks and arrows." },
            { id: 62, q: "What is an Airflow provider?", opts: ["Task concurrency config", "Separate package extending Airflow", "Docker image", "Core operators"], ans: [1], type: "single", cat: "Providers", exp: "Providers are packages adding integrations." },
            { id: 63, q: "Is SQLSensor with poke_interval=30 checking every 30 minutes?", opts: ["Yes", "No"], ans: [1], type: "single", cat: "Sensors", exp: "No! poke_interval is in SECONDS. 30 = 30 seconds." },
            { id: 64, q: "CLI command to create the metadata database?", opts: ["airflow db start", "airflow db reset", "airflow db check", "airflow db migrate"], ans: [3], type: "single", cat: "CLI", exp: "airflow db migrate creates/upgrades the schema." },
            { id: 65, q: "Error: '_TaskDecorator' object has no attribute 'update_relative'. Solution?", opts: ["Call the task explicitly", "Change start_date format", "Import correct DAG object", "Not enough info"], ans: [0], type: "single", cat: "Troubleshooting", exp: "Call tasks: task_a() >> task_b()" },
            { id: 66, q: "Method to get data from XCom?", opts: ["xcom_push", "xcom_add", "xcom_pull", "xcom parameter"], ans: [2], type: "single", cat: "XCom", exp: "Use xcom_pull to retrieve data." },
            { id: 67, q: "Is t0 >> t1 >> t2 >> t3 equivalent to t3 << t2 << t1 << t0?", opts: ["No", "Yes"], ans: [1], type: "single", cat: "Dependencies", exp: "Yes, both create t0 â†’ t1 â†’ t2 â†’ t3." },
            { id: 68, q: "Where are task dependencies set up?", opts: ["In /includes directory", "In the DAG file", "In the Airflow UI", "In a config file"], ans: [1], type: "single", cat: "DAG Definition", exp: "Dependencies are defined in the DAG Python file." },
            { id: 69, q: "Purpose of catchup parameter?", opts: ["Determines schedule interval", "Determines future runs", "Determines retry count", "Determines retroactive runs"], ans: [3], type: "single", cat: "DAG Parameters", exp: "catchup controls backfilling past intervals." },
            { id: 70, q: "Which returns 'my_json' as a Python dict?", opts: ["Variable.retrieve('my_json', deserialize_json=True)", "Variable.get('my_json', deserialize_json=True)", "Variable.retrieve('my_json', deserialize_json=False)", "Variable.get('my_json')"], ans: [1], type: "single", cat: "Variables", exp: "Variable.get() with deserialize_json=True." },
            { id: 71, q: "Is [t0, t1] >> [t2, t3] valid?", opts: ["No", "Yes"], ans: [1], type: "single", cat: "Dependencies", exp: "Yes, creates cross-dependencies." },
            { id: 72, q: "Schedule for daily at 7:00 AM?", opts: ["schedule='7 * * * *'", "schedule='0 7 * * *'", "schedule=timedelta(hours=6)", "schedule=timedelta(hours=7)"], ans: [1], type: "single", cat: "Scheduling", exp: "'0 7 * * *' = minute 0, hour 7, daily." },
            { id: 73, q: "Default time for new DAG file to appear?", opts: ["1 minute", "30 seconds", "5 minutes", "1 second"], ans: [2], type: "single", cat: "Configuration", exp: "dag_dir_list_interval defaults to 5 minutes." },
            { id: 74, q: "UI shows 2 DAGs but expecting 5. Why?", opts: ["5-minute delay", "A filter is applied", "30-second delay", "Airflow error"], ans: [1], type: "single", cat: "UI", exp: "A tag filter is likely applied." },
            { id: 75, q: "Purpose of schedule parameter?", opts: ["When scheduling starts", "How often DAG runs", "When scheduling stops", "Timezone for DAG"], ans: [1], type: "single", cat: "DAG Parameters", exp: "schedule defines how often the DAG runs." }
        ];

        let userAnswers = {};
        let submitted = false;

        function showTab(mode) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(mode + '-section').classList.add('active');
            
            document.getElementById('actions').style.display = mode === 'quiz' ? 'flex' : 'none';
            document.getElementById('results').classList.remove('show');
            
            if (mode === 'study') renderStudy();
            else if (mode === 'quiz') renderQuiz();
            else if (mode === 'answers') renderAnswers();
            
            window.scrollTo(0, 0);
        }

        function renderStudy() {
            const el = document.getElementById('study-section');
            if (el.innerHTML) return;
            el.innerHTML = questions.map(q => `
                <div class="question">
                    <div class="q-meta"><span class="q-num">Q${q.id}</span><span class="q-cat">${q.cat}</span></div>
                    <div class="q-text">${q.q.replace(/\n/g, '<br>')}</div>
                    <div class="options">${q.opts.map((o, i) => `
                        <div class="opt ${q.ans.includes(i) ? 'correct' : ''}">${o}</div>
                    `).join('')}</div>
                    <div class="answer">âœ“ ${q.ans.map(i => q.opts[i]).join(', ')}</div>
                    <div class="explanation"><strong>Why?</strong> ${q.exp}</div>
                </div>
            `).join('');
        }

        function renderQuiz() {
            const el = document.getElementById('quiz-section');
            if (el.innerHTML && !submitted) return;
            submitted = false;
            userAnswers = {};
            document.getElementById('results').classList.remove('show');
            document.getElementById('submit-btn').classList.remove('hidden');
            document.getElementById('reveal-btn').classList.add('hidden');
            
            el.innerHTML = questions.map(q => `
                <div class="question" id="quiz-q-${q.id}">
                    <div class="q-meta"><span class="q-num">Q${q.id}</span><span class="q-cat">${q.cat}</span></div>
                    <div class="q-text">${q.q.replace(/\n/g, '<br>')}</div>
                    <div class="options">${q.opts.map((o, i) => `
                        <label class="opt" id="q${q.id}-o${i}">
                            <input type="${q.type === 'multiple' ? 'checkbox' : 'radio'}" name="q${q.id}" value="${i}" onchange="record(${q.id}, ${i}, '${q.type}')">
                            ${o}
                        </label>
                    `).join('')}</div>
                </div>
            `).join('');
        }

        function renderAnswers() {
            const el = document.getElementById('answers-section');
            if (el.innerHTML) return;
            el.innerHTML = questions.map(q => `
                <div class="question">
                    <div class="q-meta"><span class="q-num">Q${q.id}</span><span class="q-cat">${q.cat}</span></div>
                    <div class="q-text">${q.q.replace(/\n/g, '<br>')}</div>
                    <div class="options">${q.opts.map((o, i) => `
                        <div class="opt ${q.ans.includes(i) ? 'correct' : ''}">${o}</div>
                    `).join('')}</div>
                </div>
            `).join('');
        }

        function record(qid, oid, type) {
            if (submitted) return;
            if (type === 'multiple') {
                if (!userAnswers[qid]) userAnswers[qid] = [];
                const idx = userAnswers[qid].indexOf(oid);
                if (idx > -1) userAnswers[qid].splice(idx, 1);
                else userAnswers[qid].push(oid);
            } else {
                userAnswers[qid] = [oid];
            }
        }

        function submitQuiz() {
            submitted = true;
            let correct = 0;
            
            questions.forEach(q => {
                const user = (userAnswers[q.id] || []).sort();
                const ans = [...q.ans].sort();
                const isCorrect = JSON.stringify(user) === JSON.stringify(ans);
                if (isCorrect) correct++;
                
                q.opts.forEach((_, i) => {
                    const optEl = document.getElementById(`q${q.id}-o${i}`);
                    if (optEl) {
                        optEl.classList.remove('correct', 'wrong');
                        if (user.includes(i) && ans.includes(i)) optEl.classList.add('correct');
                        else if (user.includes(i)) optEl.classList.add('wrong');
                    }
                });
            });
            
            const pct = Math.round((correct / questions.length) * 100);
            document.getElementById('score').textContent = pct + '%';
            document.getElementById('correct').textContent = correct;
            document.getElementById('wrong').textContent = questions.length - correct;
            document.getElementById('score-msg').textContent = pct >= 70 ? 'ðŸŽ‰ Passed!' : 'ðŸ“š Keep studying';
            document.getElementById('score-msg').className = 'score-msg ' + (pct >= 70 ? 'pass' : 'fail');
            document.getElementById('results').classList.add('show');
            document.getElementById('submit-btn').classList.add('hidden');
            document.getElementById('reveal-btn').classList.remove('hidden');
            document.querySelectorAll('#quiz-section input').forEach(i => i.disabled = true);
            window.scrollTo(0, 0);
        }

        function revealAnswers() {
            questions.forEach(q => {
                q.opts.forEach((_, i) => {
                    const optEl = document.getElementById(`q${q.id}-o${i}`);
                    if (optEl && q.ans.includes(i)) optEl.classList.add('correct');
                });
            });
        }

        function resetQuiz() {
            document.getElementById('quiz-section').innerHTML = '';
            renderQuiz();
        }

        // Initialize
        renderStudy();
    </script>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="backToTop" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" aria-label="Back to top">
        <i class="fas fa-arrow-up"></i>
    </button>
    <script>
        const backToTopBtn = document.getElementById('backToTop');
        if (backToTopBtn) {
            window.addEventListener('scroll', () => {
                backToTopBtn.classList.toggle('show', window.pageYOffset > 300);
            });
        }
    </script>
</body>
</html>

